# MyDNS-Adapter

MyDNS.JP Adapter for Windows : IPアドレス通知ツール

このツールは、Windows環境で動作するコマンドラインツールおよびWindowsサービスです。
MyDNS.JPに対して定期的にIPアドレス通知します。

## 主な機能

*   **Windowsサービス実行**: 一度インストールすれば、バックグラウンドで自動的にIPアドレスを監視・通知します。
*   **マルチアカウント対応**: 複数のMyDNS.JPアカウントを登録し、一括で管理できます。
*   **IPv4/IPv6両対応**: IPv4とIPv6のIPアドレスをそれぞれ通知するかどうか、アカウントごとに設定できます。
*   **シンプルなCLI**: コマンドラインから対話的にアカウントの追加・編集・削除ができます。
*   **ログ機能**: サービスや通知の実行結果は、実行ファイルと同じディレクトリの `mydns.log` に記録されます。

## クイックスタート

### 1. ビルド

Rustのツールチェインが必要です。以下のコマンドでリリースビルドを行います。

```sh
cargo build --release
```

### 2. アカウントの追加

まず、通知したいMyDNS.JPのアカウント情報を登録します。

```sh
# 対話モードでアカウントを追加
.\target\release\mydns-adapter-win11.exe --add
```

### 3. Windowsサービスとしてインストール

ビルドして生成された `target\release\mydns-adapter-win11.exe` 、もしくはReleaseからダウンロードした実行形式ファイル `mydns-adapter-win11.exe` を、`C:\MyDNS-Adapter\` のような任意の永続的なディレクトリにコピーします。

次に、管理者権限でコマンドプロンプトまたはPowerShellを開き、コピー先のディレクトリから以下のコマンドを実行してサービスをインストール・開始します。

```sh
# C:\MyDNS-Adapter にコピーした場合の例
cd C:\MyDNS-Adapter
.\mydns-adapter-win11.exe --install
```

## コマンド一覧

| オプション                | 短縮形 | 説明                                                               |
| ------------------------- | ------ | ------------------------------------------------------------------ |
| `--add`                   |        | 新しいアカウント設定を対話的に追加します。                         |
| `--edit [MASTER_ID]`      | `-e`   | 既存のアカウント設定を編集します。IDを省略すると対話的に選択します。 |
| `--remove <MASTER_ID>`    |        | 指定されたMasterIDのアカウント設定を削除します。                   |
| `--view`                  | `-v`   | 現在の設定を一覧表示します。                                       |
| `--list`                  | `-l`   | `--view` と同じです。                                              |
| `--notify`                | `-n`   | 設定されているすべてのアカウントで、IPv4/IPv6アドレスを即時通知します。 |
| `--ipv4`                  | `-4`   | IPv4アドレスのみを即時通知します。                                 |
| `--ipv6`                  | `-6`   | IPv6アドレスのみを即時通知します。                                 |
| `--install`               |        | Windowsサービスとしてインストールし、開始します。（要管理者権限）    |
| `--uninstall`             |        | Windowsサービスを停止し、アンインストールします。（要管理者権限）   |
| `--restart`               | `-r`   | Windowsサービスを再起動します。（要管理者権限）                     |

## 設定の保存場所

このツールで登録したアカウント情報（MasterID、パスワードなど）は、Windowsレジストリに安全に保存されます。
*   パス: `HKEY_LOCAL_MACHINE\Software\MyDNSAdapter`

## ライセンス

このプロジェクトはMITライセンスです。詳細はプロジェクトルートの `LICENSE.md` ファイルをご覧ください。
